-D
-b 8192
-f 1
-r 0

-a always,exit -F arch=b64 -S connect,accept -F auid>=1000 -F auid!=unset -k external_access
-a always,exit -F arch=b32 -S connect,accept -F auid>=1000 -F auid!=unset -k external_access

-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful_perm_change
-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful_perm_change
-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -k unsuccessful_perm_change
-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F exit=-EPERM -F auid>=1000 -F auid!=unset -k unsuccessful_perm_change

-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F success=1 -F auid>=1000 -F auid!=unset -k successful_perm_change
-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat,setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F success=1 -F auid>=1000 -F auid!=unset -k successful_perm_change


-a always,exit -F arch=b32 -S chown,fchown,lchown,fchownat -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful_owner_change
-a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful_owner_change
-a always,exit -F arch=b32 -S chown,fchown,lchown,fchownat -F exit=-EPERM  -F auid>=1000 -F auid!=unset -k unsuccessful_owner_change
-a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F exit=-EPERM  -F auid>=1000 -F auid!=unset -k unsuccessful_owner_change


-a always,exit -F arch=b32 -S chown,fchown,lchown,fchownat -F success=1 -F auid>=1000 -F auid!=unset -k successful_owner_change

-a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F success=1 -F auid>=1000 -F auid!=unset -k successful_owner_change

-w /etc/audit/ -p wa -k audit_config
-w /var/log/audit/ -p wa -k audit_logs

-w /etc/passwd -p wa -k identity
-w /etc/group -p wa -k identity
-w /etc/shadow -p wa -k identity
-w /etc/gshadow -p wa -k identity
-w /etc/security/opasswd -p wa -k identity

-w /etc/sudoers -p wa -k sudo_config
-w /etc/sudoers.d/ -p wa -k sudo_config

-a always,exit -F arch=b64 -S adjtimex,settimeofday,clock_settime -k time_change
-a always,exit -F arch=b32 -S adjtimex,settimeofday,clock_settime -k time_change
-w /etc/localtime -p wa -k time_change

-a always,exit -F arch=b64 -S sethostname,setdomainname -k net_change
-a always,exit -F arch=b32 -S sethostname,setdomainname -k net_change
-w /etc/hosts -p wa -k net_change
-w /etc/hostname -p wa -k net_change
-w /etc/resolv.conf -p wa -k net_change
-w /etc/netplan/ -p wa -k net_change
-w /etc/network/ -p wa -k net_change

-w /etc/ssh/sshd_config -p wa -k ssh_config
-w /etc/ssh/ssh_config -p wa -k ssh_config
-w /etc/ssh/sshd_config.d/ -p wa -k ssh_config
-w /etc/ssh/ssh_config.d/ -p wa -k ssh_config

-w /var/run/utmp -p wa -k session
-w /var/log/wtmp -p wa -k session
-w /var/log/btmp -p wa -k session
-w /var/log/lastlog -p wa -k session

-w /usr/bin/sudo -p x -k priv_cmd
-w /bin/su -p x -k priv_cmd

-a always,exit -F arch=b32 -F path=/usr/bin/systemd-run -F perm=x -F auid!=unset -k maybe_escalation
-a always,exit -F arch=b64 -F path=/usr/bin/systemd-run -F perm=x -F auid!=unset -k maybe_escalation
-a always,exit -F arch=b32 -F path=/usr/bin/pkexec -F perm=x -F auid!=unset -k maybe_escalation
-a always,exit -F arch=b64 -F path=/usr/bin/pkexec -F perm=x -F auid!=unset -k maybe_escalation

-a always,exit -F arch=b64 -S execve -F euid=0 -F auid>=1000 -F auid!=unset -k root_exec
-a always,exit -F arch=b32 -S execve -F euid=0 -F auid>=1000 -F auid!=unset -k root_exec

-a always,exit -F arch=b64 -S execve -C uid!=euid -k priv_esc
-a always,exit -F arch=b32 -S execve -C uid!=euid -k priv_esc

-a always,exit -F arch=b64 -S mount,umount2 -F auid>=1000 -F auid!=unset -k mounts
-a always,exit -F arch=b32 -S mount,umount2 -F auid>=1000 -F auid!=unset -k mounts

-a always,exit -F arch=b64 -S init_module,finit_module,delete_module -k kernel_modules
-a always,exit -F arch=b32 -S init_module,finit_module,delete_module -k kernel_modules
-w /sbin/insmod -p x -k kernel_modules
-w /sbin/rmmod -p x -k kernel_modules
-w /sbin/modprobe -p x -k kernel_modules

-w /etc/crontab -p wa -k cron
-w /etc/cron.d/ -p wa -k cron
-w /etc/cron.daily/ -p wa -k cron
-w /etc/cron.hourly/ -p wa -k cron
-w /etc/cron.weekly/ -p wa -k cron
-w /etc/cron.monthly/ -p wa -k cron
-w /var/spool/cron/crontabs/ -p wa -k cron

-w /usr/bin/passwd -p x -k passwd_mod
-w /usr/sbin/useradd -p x -k user_mgmt
-w /usr/sbin/usermod -p x -k user_mgmt
-w /usr/sbin/adduser -p x -k user_mgmt
-w /usr/sbin/groupadd -p x -k group_mgmt
-w /usr/sbin/groupmod -p x -k group_mgmt
-w /usr/sbin/addgroup -p x -k group_mgmt

-a always,exit -F arch=b64 -S memfd_create -k anon_file_create
-a always,exit -F arch=b32 -S memfd_create -k anon_file_create

-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat,rmdir -F auid>=1000 -F auid!=unset -k delete
-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat,rmdir -F auid>=1000 -F auid!=unset -k delete

-a always,exit -F arch=b32 -S open,openat,openat2,open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful_access
-a always,exit -F arch=b64 -S open,openat,openat2,open_by_handle_at -F exit=-EACCES -F auid>=1000 -F auid!=unset -k unsuccessful_access
-a always,exit -F arch=b32 -S open,openat,openat2,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -k unsuccessful_access
-a always,exit -F arch=b64 -S open,openat,openat2,open_by_handle_at -F exit=-EPERM -F auid>=1000 -F auid!=unset -k unsuccessful_access

-w /usr/bin/apt -p x -k software_installer
-w /usr/bin/apt-get -p x -k software_installer
-w /usr/bin/dpkg -p x -k software_installer

-w /usr/bin/snap -p x -k software_installer

-w /usr/bin/pip -p x -k software_installer
-w /usr/bin/pip3 -p x -k software_installer


-w /usr/bin/wget -p x -k susp_activity
-w /usr/bin/curl -p x -k susp_activity
-w /usr/bin/base64 -p x -k susp_activity

-w /bin/nc -p x -k susp_activity
-w /bin/netcat -p x -k susp_activity

-w /usr/bin/ssh -p x -k susp_activity
-w /usr/bin/scp -p x -k susp_activity
-w /usr/bin/sftp -p x -k susp_activity
-w /usr/bin/ftp -p x -k susp_activity

-w /usr/bin/ss -p x -k susp_activity
-w /usr/bin/netstat -p x -k susp_activity

-e 2

